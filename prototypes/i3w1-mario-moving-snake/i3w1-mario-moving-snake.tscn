[gd_scene load_steps=15 format=3 uid="uid://conjbnlbys8si"]

[ext_resource type="Script" path="res://addons/pronto/behaviors/PlatformerController.gd" id="1_k6ccx"]
[ext_resource type="Script" path="res://addons/pronto/behaviors/Placeholder.gd" id="2_4csiw"]
[ext_resource type="Script" path="res://addons/pronto/behaviors/Collision.gd" id="3_d87vf"]
[ext_resource type="PackedScene" uid="uid://bxfi5wgcdsuep" path="res://prototypes/i3w1-mario-moving-snake/snake_follow_path.tscn" id="4_acklm"]
[ext_resource type="Script" path="res://addons/pronto/helpers/Connection.gd" id="4_dsv2v"]
[ext_resource type="Script" path="res://addons/pronto/behaviors/PrototypingUI.gd" id="7_35hwo"]
[ext_resource type="Script" path="res://addons/pronto/behaviors/Always.gd" id="7_qg1f6"]
[ext_resource type="Script" path="res://addons/pronto/behaviors/Value.gd" id="8_egddh"]
[ext_resource type="PackedScene" uid="uid://dlkhmn7b7r5dk" path="res://prototypes/i3w1-mario-moving-snake/blue_platform.tscn" id="9_2wha8"]

[sub_resource type="Resource" id="Resource_0vnuq"]
script = ExtResource("4_dsv2v")
signal_name = "collided"
to = NodePath("")
invoke = ""
arguments = []
only_if = "return other.paused and abs(direction.angle_to(Vector2.DOWN)) < PI/4"
expression = "other.activate_snake()"

[sub_resource type="Resource" id="Resource_xx2so"]
script = ExtResource("4_dsv2v")
signal_name = "collided"
to = NodePath("")
invoke = ""
arguments = []
only_if = "return other.get_node(\"TriggerClock\").paused"
expression = "var clock = other.get_node(\"TriggerClock\")
var time = at(\"BluePlatformTriggerTime\")
clock.duration_seconds = time
clock.reset_and_start()"

[sub_resource type="Curve2D" id="Curve2D_c2osk"]
_data = {
"points": PackedVector2Array(0, 0, 0, 0, 54, 74, 0, 0, 0, 0, 300, 0, 0, 0, 0, 0, 500, 74, 0, 0, 0, 0, 54, 74)
}
point_count = 4

[sub_resource type="Resource" id="Resource_mshn6"]
script = ExtResource("4_dsv2v")
signal_name = "always"
to = NodePath("../MovingPlatform")
invoke = ""
arguments = []
only_if = "return true"
expression = "var speed = at(\"PlatformSpeed\")
var _follow = get_parent()
_follow.set_progress(_follow.get_progress() + speed * delta)"

[sub_resource type="Curve2D" id="Curve2D_bjdnm"]
_data = {
"points": PackedVector2Array(0, 0, 0, 0, 300, 300, 0, 0, 0, 0, 600, 300, 0, 0, 0, 0, 600, 100, 0, 0, 0, 0, 800, 100)
}
point_count = 4

[node name="i3w1-mario-moving-snake" type="Node2D"]

[node name="Player" type="CharacterBody2D" parent="." groups=["player"]]
position = Vector2(242, 508)
collision_layer = 3

[node name="PlatformerController" type="Node2D" parent="Player"]
script = ExtResource("1_k6ccx")
jump_velocity = 500.0
horizontal_velocity = 200.0
show_trail = true

[node name="Placeholder" type="Node2D" parent="Player"]
script = ExtResource("2_4csiw")
color = Color(1, 0, 0, 1)
placeholder_size = Vector2(20, 40)

[node name="SnakeBlockTrigger" type="Node2D" parent="Player"]
position = Vector2(28, 0)
script = ExtResource("3_d87vf")
limit_to_group = "snake_block"
metadata/pronto_connections = [SubResource("Resource_0vnuq")]

[node name="DonutBlockTrigger" type="Node2D" parent="Player"]
position = Vector2(25, -26)
script = ExtResource("3_d87vf")
limit_to_group = "blue_platform"
metadata/pronto_connections = [SubResource("Resource_xx2so")]

[node name="Ground2" type="StaticBody2D" parent="."]
position = Vector2(274, 537)

[node name="Placeholder" type="Node2D" parent="Ground2"]
scale = Vector2(1.04, 1)
script = ExtResource("2_4csiw")
placeholder_size = Vector2(229, 15)

[node name="Ground" type="StaticBody2D" parent="."]
position = Vector2(572, 631)

[node name="Placeholder" type="Node2D" parent="Ground"]
scale = Vector2(1.04, 1)
script = ExtResource("2_4csiw")
placeholder_size = Vector2(1141, 25)

[node name="SimplePatformPath" type="Path2D" parent="."]
position = Vector2(404, 387)
curve = SubResource("Curve2D_c2osk")

[node name="PathFollow2D" type="PathFollow2D" parent="SimplePatformPath"]
position = Vector2(54, 74)
rotates = false

[node name="Always" type="Node2D" parent="SimplePatformPath/PathFollow2D"]
position = Vector2(-3, 51)
script = ExtResource("7_qg1f6")
metadata/pronto_connections = [SubResource("Resource_mshn6")]

[node name="MovingPlatform" type="CharacterBody2D" parent="SimplePatformPath/PathFollow2D"]

[node name="Placeholder" type="Node2D" parent="SimplePatformPath/PathFollow2D/MovingPlatform"]
script = ExtResource("2_4csiw")
color = Color(0.729412, 0.462745, 0, 1)
placeholder_size = Vector2(100, 20)

[node name="SnakePath" type="Path2D" parent="."]
position = Vector2(-198, 154)
curve = SubResource("Curve2D_bjdnm")

[node name="SnakeBlock1" parent="SnakePath" instance=ExtResource("4_acklm")]
position = Vector2(300, 300)

[node name="SnakeBlock2" parent="SnakePath" instance=ExtResource("4_acklm")]
position = Vector2(319.989, 300)
progress = 20.0

[node name="SnakeBlock3" parent="SnakePath" instance=ExtResource("4_acklm")]
position = Vector2(340.166, 300)
progress = 40.0

[node name="SnakeBlock4" parent="SnakePath" instance=ExtResource("4_acklm")]
position = Vector2(359.996, 300)
progress = 60.0

[node name="BluePlatform" parent="." instance=ExtResource("9_2wha8")]
position = Vector2(490, 323)

[node name="BluePlatform2" parent="." instance=ExtResource("9_2wha8")]
position = Vector2(459, 421)

[node name="PanelContainer" type="PanelContainer" parent="."]
offset_left = 21.0
offset_top = 11.0
offset_right = 444.0
offset_bottom = 159.0
scale = Vector2(1.28473, 1.17159)

[node name="PrototypingUI" type="Node2D" parent="PanelContainer"]
script = ExtResource("7_35hwo")

[node name="PlatformSpeed" type="Node2D" parent="PanelContainer/PrototypingUI"]
position = Vector2(33.47, 163.88)
script = ExtResource("8_egddh")
to = 200.0
value = 60.0

[node name="SnakeSpeed" type="Node2D" parent="PanelContainer/PrototypingUI"]
position = Vector2(91.848, 166.44)
script = ExtResource("8_egddh")
to = 200.0
value = 60.0

[node name="SnakeDespawnTime" type="Node2D" parent="PanelContainer/PrototypingUI"]
position = Vector2(140.107, 165.587)
script = ExtResource("8_egddh")
to = 10.0
step_size = 0.01
value = 1.0

[node name="BluePlatformTriggerTime" type="Node2D" parent="PanelContainer/PrototypingUI"]
position = Vector2(196.928, 166.44)
script = ExtResource("8_egddh")
to = 2.0
step_size = 0.1
value = 0.5

[node name="BluePlatformGravity" type="Node2D" parent="PanelContainer/PrototypingUI"]
position = Vector2(196.928, 166.44)
script = ExtResource("8_egddh")
to = 20.0
step_size = 0.25
value = 1.0

[node name="BluePlatformRespawnTime" type="Node2D" parent="PanelContainer/PrototypingUI"]
script = ExtResource("8_egddh")
to = 5.0
step_size = 0.025
value = 1.0
